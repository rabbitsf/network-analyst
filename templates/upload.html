<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>PCAP Analyzer</title>
    <style>
      body { font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; padding: 2rem; max-width: 800px; margin: 0 auto; }
      h1 { margin-bottom: 0.5rem; }
      .card { border: 1px solid #ddd; border-radius: 8px; padding: 1.5rem; margin-top: 1rem; }
      .flash { color: #b00020; margin-bottom: 1rem; }
      button { padding: 0.5rem 1rem; border-radius: 6px; border: 1px solid #333; background: #333; color: white; cursor: pointer; }
      button:hover { background: #555; }
      input[type=file] { margin: 1rem 0; }
    </style>
  </head>
  <body>
    <h1>Network PCAP Analyzer</h1>
    <p>Upload a Wireshark <code>.pcap</code> or <code>.pcapng</code> file and the agent will analyze it.</p>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash">
          {% for msg in messages %}
            <div>{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <div class="card">
      <form method="post" enctype="multipart/form-data">
        <label for="pcap_file">Choose PCAP file:</label><br>
        <input type="file" name="pcap_file" id="pcap_file" accept=".pcap,.pcapng" required><br><br>
        <button type="submit">Analyze</button>
      </form>
    </div>
  </body>
</html>

